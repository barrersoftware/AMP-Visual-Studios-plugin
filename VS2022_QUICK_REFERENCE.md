# Quick Reference: Build VSIX in Visual Studio 2022

## 🚀 Easiest Method - Automated Build

1. Open the project folder in Windows Explorer
2. Double-click `build-and-sign-vsix.bat`
3. Wait for the script to complete
4. The signed `AMPPluginTemplate.NET8.vsix` is ready!

## 📝 What You Need in Visual Studio 2022

### To Build from Source Files:
The project structure is:
```
AMP-Visual-Studios-plugin/
├── extension.vsixmanifest       ← Main manifest
├── [Content_Types].xml          ← Content types
├── catalog.json                 ← Catalog info
├── manifest.json                ← Package manifest
├── icon-*.png                   ← Icons
├── LICENSE.txt                  ← License
├── README.md                    ← Documentation
├── ProjectTemplates/            ← Template files
│   └── AMPPluginTemplate.zip    ← Actual template
├── BarrerSoftware.pfx           ← Signing certificate
├── build-and-sign-vsix.ps1      ← Build script
└── build-and-sign-vsix.bat      ← Build launcher
```

### To Create VSIX Manually in VS2022:

1. **Create New VSIX Project:**
   - File > New > Project
   - Search for "VSIX Project"
   - Create the project

2. **Add Files to VSIX Project:**
   - Copy all files from this repo to your VSIX project
   - Right-click each file > Properties > Include in VSIX = True

3. **Configure Signing:**
   - Right-click project > Properties > Signing tab
   - Check "Sign the assembly"
   - Select `BarrerSoftware.pfx`
   - Password: `BarrerSoftware2025!`

4. **Build:**
   - Build > Build Solution (Ctrl+Shift+B)
   - Find VSIX in `bin\Release\` or `bin\Debug\`

## 🔧 Alternative: Using GitHub Desktop

Since you mentioned GitHub Desktop:

1. **Clone the repo** (if not already):
   - File > Clone Repository
   - Select `barrersoftware/AMP-Visual-Studios-plugin`

2. **Open in VS Code or File Explorer:**
   - Repository > Open in File Explorer
   - Then run `build-and-sign-vsix.bat`

3. **Commit changes:**
   - Make changes in Visual Studio
   - Return to GitHub Desktop to commit
   - Push to GitHub

## 💡 PowerShell Commands

If you prefer command line:

```powershell
# Navigate to project
cd "D:\barrer-software\AMP-Visual-Studios-plugin"

# Build and sign
.\build-and-sign-vsix.ps1

# Or just sign existing VSIX
.\sign-vsix.ps1
```

## ✅ Verify Installation

After building:

1. Double-click `AMPPluginTemplate.NET8.vsix`
2. VSIX Installer will open
3. Select Visual Studio 2022
4. Click Install
5. Restart Visual Studio

## 🎯 Create New AMP Plugin

In Visual Studio 2022 (after installing template):

1. File > New > Project
2. Search for "AMP Plugin"
3. Select "AMP Plugin Template (.NET 8)"
4. Name your plugin
5. Create!

## 📦 Files Generated by build-and-sign-vsix.ps1

The script creates:
- `AMPPluginTemplate.NET8.vsix` - Signed, ready to install
- Includes all icons, manifest, and template files
- Digitally signed with Barrer Software certificate
- Can be installed directly or published to marketplace

## 🛠️ Troubleshooting

### "Not a valid VSIX package" Error
- Re-run `build-and-sign-vsix.bat`
- Make sure all files are present
- Check that signing completed successfully

### "SignTool not found" Error
- Install Windows SDK via Visual Studio Installer
- Go to: Individual Components > Windows 10 or 11 SDK

### Certificate Issues
- Password is: `BarrerSoftware2025!`
- Certificate file: `BarrerSoftware.pfx`
- Must be in the same folder as scripts

## 📤 Publishing to Marketplace

Once you have the signed VSIX:

1. Go to: https://marketplace.visualstudio.com/manage/publishers/barrersoftware
2. Upload `AMPPluginTemplate.NET8.vsix`
3. Fill in details
4. Publish!

---

**Copyright © 2025 Barrer Software. All Rights Reserved.**

Need help? The `build-and-sign-vsix.ps1` script has detailed error messages and troubleshooting tips built in.
